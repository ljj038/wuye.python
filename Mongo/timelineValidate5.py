#!/usr/bin/python
# coding=utf-8
import pymongo
import datetime
import time

sDate = '1991-11-11 11:11:11'
iTimestamp = int(time.mktime(time.strptime(sDate, '%Y-%m-%d %H:%M:%S')))
sUTCDate = datetime.datetime.utcfromtimestamp(iTimestamp)
dSchoolCount2 = {202064493: 245, 202064485: 473, 202064606: 7, 202064339: 2889, 202064455: 417, 202064355: 1216,
                 202064867: 2424, 202064478: 24, 202064795: 1246, 202064825: 174, 202064585: 6078, 202064716: 3659,
                 202064847: 992, 202064379: 138, 202064810: 748, 202064475: 4454, 202064347: 15, 202064793: 208,
                 202064459: 57, 202064591: 171, 202064588: 1692, 202064727: 379, 202064551: 380, 202064511: 436,
                 202064440: 7098, 202064571: 3013, 202064498: 1979, 202064671: 1259, 202064382: 39, 202064646: 2150,
                 202064501: 29, 202064370: 514, 202064436: 98, 202064341: 6869, 202064736: 3034, 202064333: 13,
                 202064376: 2322, 202064346: 348, 202064760: 60, 202064392: 649, 202064443: 326, 202064514: 1572,
                 202064649: 31, 202064628: 50, 202064509: 2, 202064377: 362, 202064979: 13799, 202064644: 363,
                 202064600: 135, 202064380: 26, 202064823: 687, 202064841: 3303, 202064690: 653, 202064872: 526,
                 202064410: 9, 202064402: 27, 202064531: 56, 202064556: 1809, 202064365: 236, 202064626: 167,
                 202064703: 247, 202064619: 15, 202064400: 50, 202064367: 1861, 202064616: 863, 202064495: 161,
                 202064366: 374, 202064405: 215, 202064362: 76, 202064624: 1390, 202064656: 136, 202064518: 10068,
                 202064472: 12, 202064462: 3839, 202064344: 41, 202064854: 1394, 202064359: 185, 202064833: 77,
                 202064574: 361, 202064631: 1975, 202064749: 90, 202064422: 252, 202064336: 179, 202064764: 4,
                 202064804: 439, 202064338: 283, 202064679: 671, 202064388: 380, 202064878: 240, 202064562: 916,
                 202064898: 146, 202064413: 35, 202064420: 126, 202064780: 1263, 202064445: 1353, 202064488: 813,
                 202064429: 18, 202064633: 232, 202064755: 384, 202064482: 252, 202064593: 1659, 202064609: 1170,
                 202064384: 28, 202064747: 513, 202064666: 71, 202064343: 1085, 202064349: 3000, 202064857: 154,
                 202064351: 47, 202064360: 357, 202064554: 59, 202064851: 710, 202064345: 127, 202064364: 74,
                 202064332: 10, 202064798: 104, 202064603: 337, 202064768: 2213, 202064784: 159, 202064371: 10,
                 202064565: 15, 202064721: 41, 202064706: 3889, 202064596: 969, 202064599: 322, 202064492: 52,
                 202064920: 917, 202064859: 255, 202064499: 85, 202064697: 1935, 202064819: 946, 202064665: 19,
                 202064464: 633, 202064647: 289, 202064710: 126, 202064875: 460, 202064552: 1952, 202064432: 763,
                 202064428: 372, 202064932: 2, 202064578: 3, 202064421: 80, 202064645: 106, 202064952: 26,
                 202064751: 153, 202064731: 1319, 202064754: 147, 202064513: 294, 202064779: 9, 202064570: 107,
                 202064918: 178, 202064519: 1, 202064597: 25, 202064839: 44, 202064888: 104, 202064956: 252,
                 202064660: 903, 202064705: 4, 202064567: 26, 202064879: 345, 202064958: 55, 202064787: 24,
                 202064794: 67, 202064826: 305, 202064564: 313, 202064866: 1755, 202064943: 12, 202064529: 9,
                 202064638: 134, 202064897: 595, 202064772: 199, 202064456: 566, 202064739: 143, 202064914: 418,
                 202064911: 307, 202064625: 408, 202064905: 463, 202064797: 364, 202064900: 14, 202064946: 26,
                 202064453: 67, 202064938: 366, 202064686: 161, 202064726: 767, 202064539: 1050, 202064419: 54,
                 202064817: 311, 202064622: 1634, 202064594: 382, 202064744: 1867, 202064960: 582, 202064700: 34,
                 202064737: 804, 202064517: 133, 202064909: 376, 202064515: 229, 202064733: 493, 202064715: 2180,
                 202064542: 80, 202064781: 621, 202064663: 518, 202064862: 87, 202064873: 248, 202064620: 175,
                 202064884: 502, 202064533: 464, 202064907: 149, 202064799: 216, 202064718: 71, 202064474: 10,
                 202064657: 205, 202064524: 355, 202064502: 15, 202064684: 78, 202064837: 8, 202064549: 251,
                 202064404: 16, 202064680: 808, 202064399: 287, 202064692: 151, 202064580: 333, 202064962: 101,
                 202064809: 392, 202064617: 787, 202064912: 641, 202064461: 46, 202064458: 287, 202064925: 1009,
                 202064978: 414, 202064916: 163, 202064407: 38, 202064901: 269, 202064802: 87, 202064434: 375,
                 202064605: 234, 202064444: 183, 202064948: 16, 202064757: 1, 202064643: 6255, 202064661: 789,
                 202064614: 80, 202064762: 257, 202064650: 419, 202064682: 12, 202064558: 12, 202064630: 449,
                 202064469: 72, 202064672: 3, 202064728: 833, 202064702: 32, 202064447: 190, 202064945: 283,
                 202064640: 154, 202064627: 194, 202064548: 482, 202064761: 2, 202064553: 1140, 202064812: 1651,
                 202064652: 49, 202064546: 5, 202064393: 193, 202064555: 931, 202064774: 1329, 202064483: 322,
                 202064608: 60, 202064583: 199, 202064954: 2395, 202064694: 92, 202064748: 453, 202064815: 33,
                 202064848: 895, 202064840: 576, 202064566: 4533, 202064476: 1437, 202064903: 1383, 202064934: 301,
                 202064654: 31, 202064446: 1344, 202064423: 1853, 202064689: 567, 202064941: 59, 202064522: 1852,
                 202064832: 595, 202064500: 492, 202064572: 1380, 202064526: 16, 202064712: 1, 202064881: 550,
                 202064720: 2189, 202064776: 1289, 202064611: 5, 202064936: 1916, 202064711: 4, 202064789: 1335,
                 202064414: 5, 202064894: 952, 202064765: 4114, 202064953: 74, 202064409: 795, 202064449: 335,
                 202064610: 15, 202064829: 213, 202064463: 43, 202064830: 240, 202064828: 4, 202064707: 69,
                 202064759: 3092, 202064786: 19, 202064982: 24, 202064957: 1853, 202064843: 68, 202064822: 661,
                 202064437: 1070, 202064853: 41, 202064890: 1, 202064928: 1021, 202064769: 260, 202064602: 290,
                 202064926: 2103, 202064937: 336, 202064767: 73, 202064589: 79, 202064467: 539, 202064922: 3036,
                 202064785: 237, 202064561: 46, 202064636: 150, 202064935: 1, 202064668: 1, 202064924: 7,
                 202064929: 3304, 202064439: 460, 202064484: 14, 202064831: 332, 202064537: 1360, 202064773: 182,
                 202064791: 1578, 202064869: 633, 202064426: 47, 202064438: 337, 202064688: 239, 202064504: 1235,
                 202064385: 46, 202064534: 365, 202064856: 560, 202064601: 2280, 202064930: 1164, 202064964: 11,
                 202064673: 15, 202064489: 1659, 202064487: 183, 202064670: 693, 202064742: 238, 202064871: 684,
                 202064790: 38, 202064648: 21, 202064590: 864, 202064919: 578, 202064621: 187, 202064973: 100,
                 202064921: 8, 202064940: 1096, 202064584: 237, 202064740: 258, 202064959: 998, 202064966: 464,
                 202064967: 25, 202064955: 8, 202064976: 177, 202064577: 263, 202064722: 458, 202064927: 5,
                 202064629: 112, 202064527: 211, 202064401: 5, 202064811: 6, 202064880: 630, 202064503: 1, 202064753: 1,
                 202064714: 212, 202064949: 60, 202064800: 2594, 202064604: 120, 202064806: 405, 202064575: 1,
                 202064595: 20, 202064858: 740, 202064868: 101, 202064667: 1184, 202064971: 165, 202064977: 751,
                 202064963: 665, 202064560: 559, 202064874: 175, 202064923: 3156, 202064942: 1843, 202064915: 8,
                 202064882: 1466, 202064849: 394, 202064917: 147, 202064933: 3, 202064931: 16, 202064770: 545,
                 202064468: 720, 202064658: 745, 202064746: 26, 202064968: 499, 202064735: 67, 202064808: 66,
                 202064913: 320, 202064520: 367, 202064836: 875, 202064441: 54, 202064814: 244, 202064433: 299,
                 202064821: 4, 202064403: 466, 202064699: 142, 202064454: 1670, 202064877: 91, 202064678: 102,
                 202064543: 38, 202064424: 3471, 202064471: 19, 202064818: 1532, 202064834: 6, 202064512: 305,
                 202064450: 2762, 202064496: 364, 202064908: 269, 202064408: 213, 202064466: 3, 202064846: 4134,
                 202064430: 34, 202064750: 634, 202064972: 147, 202064486: 6315, 202064508: 388, 202064406: 17,
                 202064729: 390, 202064717: 478, 202064685: 1499, 202064778: 1230, 202064965: 437, 202064607: 16,
                 202064387: 67, 202064391: 8, 202064395: 938, 202064970: 182, 202064525: 37, 202064538: 19,
                 202064975: 3309, 202064745: 1, 202064615: 770, 202064969: 512, 202064581: 1735, 202064701: 565,
                 202064951: 260, 202064738: 1209, 202064523: 394, 202064540: 1502, 202064416: 16, 202064642: 7261,
                 202064592: 604, 202064683: 1660, 202064732: 496, 202064473: 116, 202064411: 43, 202064756: 26,
                 202064674: 939, 202064860: 1255, 202064902: 23, 202064507: 203, 202064635: 81, 202064348: 154,
                 202064641: 5074, 202064510: 37, 202064887: 838, 202064782: 15, 202064415: 5661, 202064358: 79,
                 202064452: 2973, 202064693: 62, 202064883: 2140, 202064550: 5, 202064896: 238, 202064357: 576,
                 202064719: 76, 202064470: 865, 202064763: 909, 202064696: 63, 202064708: 814, 202064639: 2229,
                 202064418: 121, 202064390: 120, 202064664: 803, 202064350: 1574, 202064864: 155, 202064910: 1841,
                 202064378: 105, 202064743: 180, 202064563: 13, 202064792: 2048, 202064820: 46, 202064582: 35,
                 202064494: 21, 202064651: 682, 202064895: 283, 202064824: 7360, 202064398: 28, 202064342: 1089,
                 202064521: 1396, 202064544: 506, 202064394: 671, 202064335: 33, 202064448: 1, 202064653: 355,
                 202064775: 27, 202064337: 4, 202064559: 59, 202064904: 223, 202064375: 261, 202064573: 2,
                 202064457: 47, 202064598: 24531, 202064612: 140, 202064687: 791, 202064435: 9, 202064353: 3,
                 202064528: 410, 202064579: 379, 202064417: 578, 202064852: 328, 202064734: 35, 202064568: 8,
                 202064477: 106, 202064698: 43, 202064505: 396, 202064354: 6, 202064535: 312, 202064373: 505,
                 202064586: 25, 202064479: 56, 202064816: 32, 202064885: 73, 202064334: 166, 202064713: 169,
                 202064766: 16, 202064659: 1176, 202064569: 1, 202064425: 207, 202064431: 552, 202064491: 5227,
                 202064752: 2035, 202064892: 1178, 202064788: 7, 202064623: 3401, 202064758: 293, 202064801: 23,
                 202064876: 818, 202064691: 272, 202064777: 998, 202064368: 1276, 202064541: 207, 202064725: 181,
                 202064889: 606, 202064386: 420, 202064396: 46, 202064383: 35, 202064363: 481, 202064947: 83,
                 202064655: 107, 202064695: 11, 202064724: 133, 202064374: 97, 202064361: 296, 202064835: 1295,
                 202064730: 2009, 202064845: 1362, 202064340: 7, 202064618: 61, 202064637: 124, 202064886: 232,
                 202064961: 1, 202064369: 3371, 202064576: 99, 202064771: 225, 202064844: 187, 202064506: 22,
                 202064891: 1052, 202064861: 233, 202064352: 567, 202064662: 910, 202064813: 533, 202064677: 507,
                 202064465: 98, 202064681: 1504, 202064427: 1189, 202064838: 29, 202064381: 225, 202064547: 225}

iNum = 0
for key, value in dict.iteritems(dSchoolCount2):
    iNum += int(value)

print('total=>%s' % iNum)

# 建立连接
objClient = pymongo.MongoClient("114.55.137.9", 20000)
# 设置操作的 database
objDB = objClient['timeline']
for key, value in dict.iteritems(dSchoolCount2):
    # 设置操作的集合 collection
    collection = 'zhs_timeline_%d' % (int(key) % 2000)
    iCount = objDB[collection].find({"deleted_time": sUTCDate, "school_id": key}).count()
    if (iCount != value):
        print(key, collection, iCount, value, 'fail')
    else:
        print(key, collection, iCount, value, 'ok')
